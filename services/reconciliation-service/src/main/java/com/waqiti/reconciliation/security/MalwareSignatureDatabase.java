package com.waqiti.reconciliation.security;

import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Service;

import java.util.Arrays;
import java.util.List;

/**
 * Malware signature database service
 */
@Service
@Slf4j
public class MalwareSignatureDatabase {
    
    /**
     * Get all known malware signatures
     */
    public List<MalwareSignature> getAllSignatures() {
        return Arrays.asList(
            MalwareSignature.builder()
                .name("Generic JavaScript Malware")
                .pattern("eval(")
                .description("JavaScript eval injection")
                .severity("HIGH")
                .build(),
                
            MalwareSignature.builder()
                .name("VBScript Malware")
                .pattern("CreateObject(\"WScript.Shell\")")
                .description("VBScript shell execution")
                .severity("HIGH")
                .build(),
                
            MalwareSignature.builder()
                .name("PowerShell Malware")
                .pattern("powershell.exe")
                .description("PowerShell execution")
                .severity("MEDIUM")
                .build(),
                
            MalwareSignature.builder()
                .name("Document Macro Malware")
                .pattern("Auto_Open")
                .description("Auto-executing macro")
                .severity("HIGH")
                .build(),
                
            MalwareSignature.builder()
                .name("Suspicious Shell Command")
                .pattern("cmd.exe /c")
                .description("Command line execution")
                .severity("MEDIUM")
                .build()
        );
    }
}