package com.waqiti.reconciliation.security;

import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Service;

import java.util.Set;

/**
 * Malware hash database service
 */
@Service
@Slf4j
public class MalwareHashDatabase {
    
    // Known malware hashes (in production this would be a comprehensive database)
    private static final Set<String> KNOWN_MALWARE_HASHES = Set.of(
        "5d41402abc4b2a76b9719d911017c592", // Example MD5
        "adc83b19e793491b1c6ea0fd8b46cd9f32e592fc", // Example SHA1
        "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855" // Example SHA256
    );
    
    /**
     * Check if hash is known malware
     */
    public boolean isKnownMalwareHash(String hash) {
        if (hash == null || hash.trim().isEmpty()) {
            return false;
        }
        
        String normalizedHash = hash.toLowerCase().trim();
        boolean isKnownMalware = KNOWN_MALWARE_HASHES.contains(normalizedHash);
        
        if (isKnownMalware) {
            log.warn("Known malware hash detected: {}", hash);
        }
        
        return isKnownMalware;
    }
    
    /**
     * Add new malware hash to database
     */
    public void addMalwareHash(String hash) {
        if (hash != null && !hash.trim().isEmpty()) {
            // In production, this would update the database
            log.info("New malware hash added to database: {}", hash);
        }
    }
}