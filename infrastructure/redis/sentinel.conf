# Waqiti Platform - Redis Sentinel Configuration
# Provides automatic failover for Redis Master-Replica setup

port 26379

# Sentinel will monitor the master named "waqiti-master"
# Quorum of 2 means at least 2 sentinels must agree before failover
sentinel monitor waqiti-master redis-master 6379 2

# Authentication
sentinel auth-pass waqiti-master ${REDIS_PASSWORD}

# Master is considered down after 5 seconds of no response
sentinel down-after-milliseconds waqiti-master 5000

# Only 1 replica can be reconfigured at a time during failover
sentinel parallel-syncs waqiti-master 1

# Failover timeout (milliseconds)
sentinel failover-timeout waqiti-master 10000

# Notification script (optional - for alerting)
# sentinel notification-script waqiti-master /path/to/notification-script.sh

# Client reconfiguration script (optional)
# sentinel client-reconfig-script waqiti-master /path/to/reconfig-script.sh

# Sentinel will deny commands from unknown clients
sentinel deny-scripts-reconfig yes

# Log level
loglevel notice

# Log file (stdout in Docker)
logfile ""

# Working directory
dir /data

# Sentinel will announce itself to clients
sentinel announce-ip ${SENTINEL_ANNOUNCE_IP}
sentinel announce-port 26379
